<!DOCTYPE html>
<html lang="th" class="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Aetherium Meta-Organization Resonance Console</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            bg: '#070b17',
            panel: '#121a31',
            panelSoft: '#182343',
            accent: '#22d3ee',
            good: '#34d399',
            warn: '#f59e0b'
          }
        }
      }
    };
  </script>
</head>
<body class="bg-bg text-slate-100 min-h-screen">
  <div class="max-w-7xl mx-auto px-4 py-5 space-y-4">
    <header class="rounded-xl bg-panel border border-slate-700 p-4 space-y-2">
      <h1 class="text-2xl font-bold">Aetherium Meta-Organization Resonance Console</h1>
      <p class="text-sm text-slate-300">แพลตฟอร์ม “บริษัททุกบริษัท” ด้วย Universal Role Language + Resonance Intelligence สำหรับ LLM (รองรับทั้งห้องรวมและแชทรายตำแหน่ง)</p>
      <div class="grid md:grid-cols-3 gap-2 text-xs">
        <div class="rounded-lg bg-slate-900 border border-slate-700 p-2"><span class="text-accent font-semibold">Throughput</span><br/>15,000,000 msg/sec (Tachyon SIMD)</div>
        <div class="rounded-lg bg-slate-900 border border-slate-700 p-2"><span class="text-accent font-semibold">Latency</span><br/>Sub-microsecond + IPW speculative execution</div>
        <div class="rounded-lg bg-slate-900 border border-slate-700 p-2"><span class="text-accent font-semibold">Bandwidth</span><br/>4x 800Gbps Silicon Photonics</div>
      </div>
    </header>

    <main class="grid grid-cols-1 xl:grid-cols-12 gap-4">
      <section class="xl:col-span-3 bg-panel rounded-xl border border-slate-700 p-4 space-y-3">
        <div class="flex items-center justify-between">
          <h2 class="font-semibold">Universal Role Navigator</h2>
          <span id="roleCount" class="text-xs px-2 py-1 rounded bg-slate-800"></span>
        </div>
        <div class="text-xs text-slate-400">Meta-Schema: Focus / KPI / Horizon / Capability</div>
        <div id="roleGroups" class="space-y-3"></div>
      </section>

      <section class="xl:col-span-5 bg-panel rounded-xl border border-slate-700 p-4 space-y-3">
        <h2 class="font-semibold">Role Intelligence + Resonance Card</h2>
        <div id="roleCard" class="rounded-xl bg-panelSoft border border-slate-600 p-4 space-y-4"></div>
        <div class="rounded-xl bg-slate-900 border border-slate-700 p-3 text-sm">
          <h3 class="font-semibold mb-1">Acceleration Stack</h3>
          <ul class="list-disc ml-5 text-slate-300 space-y-1">
            <li>Kernel Bypass (RDMA/DPDK) + Zero-copy path</li>
            <li>Tachyon Core (Rust SIMD) with deterministic 4,128-byte contract frames</li>
            <li>Negative Latency (IPW) for intent pre-execution</li>
          </ul>
        </div>
        <div class="rounded-xl border border-cyan-500/30 bg-cyan-500/10 p-3 text-sm" id="modeExplain"></div>
      </section>

      <section class="xl:col-span-4 bg-panel rounded-xl border border-slate-700 p-4 flex flex-col min-h-[680px]">
        <div class="flex items-center justify-between mb-3 gap-2">
          <h2 class="font-semibold">Resonance LLM Chat</h2>
          <div class="flex bg-slate-900 rounded-lg p-1 text-xs">
            <button id="modeGlobal" class="px-3 py-1 rounded bg-accent text-slate-900 font-semibold">ห้องรวม</button>
            <button id="modeRole" class="px-3 py-1 rounded text-slate-300">รายตำแหน่ง</button>
          </div>
        </div>

        <div class="grid grid-cols-2 gap-2 mb-3">
          <div>
            <label class="text-xs text-slate-400">บทบาทสนทนา</label>
            <select id="chatRoleSelect" class="w-full mt-1 bg-slate-900 border border-slate-600 rounded px-2 py-2 text-sm"></select>
          </div>
          <div>
            <label class="text-xs text-slate-400">C-Level Mode Switch (&lt;1s)</label>
            <select id="contextMode" class="w-full mt-1 bg-slate-900 border border-slate-600 rounded px-2 py-2 text-sm">
              <option value="visionary">Visionary (3Y)</option>
              <option value="crisis">Crisis Manager (Daily)</option>
            </select>
          </div>
        </div>

        <div class="grid grid-cols-3 gap-2 mb-3 text-xs">
          <div><label class="text-slate-400">ความเร็ว</label><select id="freqSpeed" class="w-full mt-1 bg-slate-900 border border-slate-600 rounded px-2 py-1"><option value="fast">เร็ว</option><option value="balanced" selected>สมดุล</option><option value="deliberate">ละเอียด</option></select></div>
          <div><label class="text-slate-400">ระดับรายละเอียด</label><select id="detailDepth" class="w-full mt-1 bg-slate-900 border border-slate-600 rounded px-2 py-1"><option value="summary">ภาพรวม</option><option value="standard" selected>มาตรฐาน</option><option value="deep">เชิงลึก</option></select></div>
          <div><label class="text-slate-400">รูปแบบคำตอบ</label><select id="responseFormat" class="w-full mt-1 bg-slate-900 border border-slate-600 rounded px-2 py-1"><option value="numbers">ตัวเลข</option><option value="mixed" selected>ผสม</option><option value="story">เชิงเล่าเรื่อง</option></select></div>
        </div>

        <div id="chatWindow" class="flex-1 overflow-y-auto rounded-xl bg-slate-900 border border-slate-700 p-3 space-y-3"></div>
        <div class="mt-3 flex gap-2">
          <input id="chatInput" class="flex-1 bg-slate-900 border border-slate-600 rounded px-3 py-2 text-sm" placeholder="เช่น สลับจาก Visionary เป็น Crisis แล้วจัดการเหตุหยุดชะงักซัพพลายเชนทันที" />
          <button id="sendBtn" class="px-4 py-2 rounded bg-good text-slate-900 font-semibold">ส่ง</button>
        </div>
      </section>
    </main>

    <section class="grid grid-cols-1 xl:grid-cols-2 gap-4">
      <div class="bg-panel rounded-xl border border-slate-700 p-4 space-y-3">
        <h2 class="font-semibold">Meta-Organization Impact Board</h2>
        <textarea id="impactPrompt" rows="3" class="w-full bg-slate-900 border border-slate-600 rounded px-3 py-2 text-sm" placeholder="ประเมินผลกระทบเมื่อ AI CEO สายเครื่องบินต้อง pivot เป็นโหมดวิกฤตภายใน 1 วินาที"></textarea>
        <button id="runImpact" class="px-4 py-2 rounded bg-warn text-slate-900 font-semibold">Evaluate</button>
        <div id="impactOutput" class="rounded-xl bg-slate-900 border border-slate-700 p-3 text-sm whitespace-pre-line min-h-[180px]"></div>
      </div>

      <div class="bg-panel rounded-xl border border-slate-700 p-4 space-y-3">
        <h2 class="font-semibold">Resonance Engine Outputs</h2>
        <div id="fingerprint" class="rounded-lg bg-slate-900 border border-slate-700 p-3 text-sm"></div>
        <div class="rounded-lg bg-slate-900 border border-slate-700 p-3 text-sm">
          <div class="font-semibold mb-1">Universal Constitution Hooks</div>
          <ul class="list-disc ml-5 text-slate-300 space-y-1">
            <li>Contract Checker + Self-healing เป็นกติกากลางของทุกอุตสาหกรรม</li>
            <li>Freeze Light ทำหน้าที่ Organizational Memory สำหรับ replay การตัดสินใจ</li>
            <li>Intent Resonance Score ติดตามความแม่นยำการสั่นพ้องระหว่างผู้ใช้กับ AI</li>
          </ul>
        </div>
      </div>
    </section>
  </div>

  <script>
    const roleData = [
      { id: 'aircraft_ceo', title: 'AI CEO - Aerospace', industry: 'Aviation', tier: 'C-Level', focus: 'Strategic safety-growth balance', kpi: 'Safety Compliance / Fleet ROI', horizon: '3Y', capability: ['Crisis governance', 'Regulatory negotiation', 'Capital allocation'], tempo: 'deliberate' },
      { id: 'chief_aircraft_engineer', title: 'Chief Engineer - Aircraft Design', industry: 'Aviation', tier: 'Leadership', focus: 'Airframe + propulsion optimization', kpi: 'Drag Coefficient / MTBF', horizon: '1Y', capability: ['Systems engineering', 'Certification readiness', 'Trade-off analysis'], tempo: 'deep' },
      { id: 'clinical_research_lead', title: 'Clinical Research Lead', industry: 'Medical', tier: 'Leadership', focus: 'Trial execution & evidence quality', kpi: 'Trial Success Rate / FDA Milestones', horizon: '1Y', capability: ['Protocol design', 'Risk stratification', 'Ethics compliance'], tempo: 'balanced' },
      { id: 'creative_director', title: 'Creative Director', industry: 'Marketing', tier: 'Leadership', focus: 'Brand narrative and campaign originality', kpi: 'Brand Recall / Engagement Rate', horizon: 'Q', capability: ['Narrative synthesis', 'Trend sensing', 'Creative critique'], tempo: 'fast' },
      { id: 'industrial_design_head', title: 'Head of Industrial Design', industry: 'Product', tier: 'Leadership', focus: 'Function + form harmonization', kpi: 'Usability Score / Material Cost', horizon: 'Q', capability: ['Human-centered design', 'Materials strategy', 'Manufacturing handoff'], tempo: 'balanced' },
      { id: 'ml_research_scientist', title: 'ML Research Scientist', industry: 'AI', tier: 'Specialist', focus: 'Model quality and serving efficiency', kpi: 'Model Accuracy / Inference Cost', horizon: 'Monthly', capability: ['Experimentation', 'Evaluation design', 'Optimization'], tempo: 'deep' },
      { id: 'operations_coordinator', title: 'Operations Coordinator', industry: 'Cross-Industry', tier: 'Operations', focus: 'Execution reliability and handoff clarity', kpi: 'On-time Delivery / SLA adherence', horizon: 'Weekly', capability: ['Scheduling', 'Escalation routing', 'Process discipline'], tempo: 'fast' }
    ];

    const styleByTier = {
      'C-Level': 'bg-fuchsia-500/20 text-fuchsia-200 border border-fuchsia-400/40',
      Leadership: 'bg-cyan-500/20 text-cyan-200 border border-cyan-400/40',
      Specialist: 'bg-emerald-500/20 text-emerald-200 border border-emerald-400/40',
      Operations: 'bg-amber-500/20 text-amber-200 border border-amber-400/40'
    };

    const state = {
      selectedRoleId: 'aircraft_ceo',
      chatMode: 'global',
      chats: { global: [{ role: 'assistant', text: 'ยินดีต้อนรับสู่ Resonance Console — เลือกบทบาทหรือเปิดห้องรวมเพื่อเริ่มประชุม AI Council.' }] },
      resonanceScore: 0.91
    };

    const getRole = (id) => roleData.find((r) => r.id === id) || roleData[0];
    const getRoomKey = () => state.chatMode === 'global' ? 'global' : `role:${state.selectedRoleId}`;

    function buildFingerprint() {
      const speed = document.getElementById('freqSpeed').value;
      const depth = document.getElementById('detailDepth').value;
      const format = document.getElementById('responseFormat').value;
      const mode = document.getElementById('contextMode').value;
      const label = mode === 'visionary' ? 'Strategic Foresight' : 'Rapid Containment';
      return {
        speed,
        depth,
        format,
        mode,
        label,
        score: Math.max(0.72, Math.min(0.99, state.resonanceScore + (mode === 'crisis' ? 0.01 : 0)))
      };
    }

    function llmRespond(role, userMessage) {
      const fp = buildFingerprint();
      const modePlan = fp.mode === 'visionary'
        ? ['1) สร้าง 3-year option map', '2) จัดลำดับการลงทุนตาม KPI สากล', '3) วาง risk envelope ระดับองค์กร']
        : ['1) เปิด war-room protocol ภายใน 1 วินาที', '2) lock decision horizon เป็น Daily', '3) reroute ทรัพยากรสู่จุดคอขวดทันที'];

      const detailMap = {
        summary: `สรุปเร็ว: ${role.title} ควรโฟกัส ${role.focus} โดยยึด KPI: ${role.kpi}`,
        standard: `ข้อเสนอสำหรับ ${role.title} (${role.industry})\n- Focus: ${role.focus}\n- KPI: ${role.kpi}\n- Horizon: ${role.horizon}\n- Capability เด่น: ${role.capability.slice(0, 2).join(', ')}`,
        deep: `Deep plan สำหรับ ${role.title}\n- Meta-Schema Mapping: Focus=${role.focus} | KPI=${role.kpi} | Horizon=${role.horizon} | Capability=${role.capability.join(', ')}\n- Resonance Mode=${fp.label}\n- Action Stack:\n  ${modePlan.join('\n  ')}`
      };

      const formatLayer = {
        numbers: `\n\nMetrics Snapshot\n- Intent Resonance Score: ${(fp.score * 100).toFixed(1)}%\n- Predicted decision cycle: ${fp.mode === 'crisis' ? '0.8s switch' : '2.4s strategic sync'}\n- Bus capacity budget: 15M msg/sec`,
        mixed: `\n\nResonance Fingerprint: speed=${fp.speed}, depth=${fp.depth}, format=${fp.format}, mode=${fp.mode}`,
        story: `\n\nNarrative: AI จับความถี่จากคำถาม “${userMessage.slice(0, 72)}” แล้วปรับโทนคำตอบให้ตรงบริบทงาน ${role.industry} แบบทันที.`
      };

      return `${detailMap[fp.depth]}\n\nUser Intent: ${userMessage}\n${formatLayer[fp.format]}`;
    }

    function evaluateImpact(prompt) {
      const role = getRole(state.selectedRoleId);
      const fp = buildFingerprint();
      const operatingModel = fp.mode === 'crisis' ? 'Daily Crisis Mesh' : '3Y Portfolio Compass';
      return `โจทย์: ${prompt || 'ยังไม่ได้ระบุโจทย์'}\n\nRole ที่ประเมิน: ${role.title}\nOperating Model: ${operatingModel}\n\nผลกระทบหลัก\n- Swarm Sync: หน่วยงานข้ามอุตสาหกรรมซิงก์ได้แบบ near real-time\n- Zero-Drift Decision: ลด perception latency ของ council feed\n- Governance: Contract + Freeze Light รักษาหลักฐานการตัดสินใจ\n\nคำแนะนำทันที\n1) ผูก KPI ร่วมด้วย Universal Taxonomy\n2) เปิด Adaptive Response Shaper ตาม Fingerprint ปัจจุบัน\n3) ติดตาม Intent Resonance Score ต่อเนื่องทุก session`;
    }

    function renderRoleGroups() {
      const grouped = roleData.reduce((acc, role) => ((acc[role.tier] = acc[role.tier] || []).push(role), acc), {});
      document.getElementById('roleGroups').innerHTML = Object.entries(grouped).map(([tier, list]) => `
        <div>
          <h3 class="text-xs text-slate-400 mb-1 uppercase tracking-wider">${tier}</h3>
          <div class="space-y-1">
            ${list.map((r) => `<button data-role-id="${r.id}" class="role-btn w-full text-left rounded-lg border px-3 py-2 transition ${state.selectedRoleId === r.id ? 'bg-accent/20 border-accent' : 'bg-slate-900 border-slate-700 hover:border-slate-500'}"><div class="text-sm font-medium">${r.title}</div><div class="text-xs text-slate-400">${r.industry} • ${r.focus}</div></button>`).join('')}
          </div>
        </div>`).join('');
      document.querySelectorAll('.role-btn').forEach((btn) => btn.onclick = () => {
        state.selectedRoleId = btn.dataset.roleId;
        renderAll();
      });
      document.getElementById('roleCount').textContent = `${roleData.length} roles`;
    }

    function renderRoleCard() {
      const r = getRole(state.selectedRoleId);
      document.getElementById('roleCard').innerHTML = `
        <div class="flex items-center justify-between gap-3 flex-wrap">
          <h3 class="text-lg font-semibold">${r.title}</h3>
          <span class="text-xs px-2 py-1 rounded ${styleByTier[r.tier] || 'bg-slate-700'}">${r.tier}</span>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-3 text-sm">
          <div class="rounded-lg border border-slate-600 p-3 bg-slate-900/60"><div class="text-slate-400 text-xs mb-1">Industry</div><div>${r.industry}</div></div>
          <div class="rounded-lg border border-slate-600 p-3 bg-slate-900/60"><div class="text-slate-400 text-xs mb-1">Focus</div><div>${r.focus}</div></div>
          <div class="rounded-lg border border-slate-600 p-3 bg-slate-900/60"><div class="text-slate-400 text-xs mb-1">KPI</div><div>${r.kpi}</div></div>
          <div class="rounded-lg border border-slate-600 p-3 bg-slate-900/60"><div class="text-slate-400 text-xs mb-1">Horizon</div><div>${r.horizon}</div></div>
        </div>
        <div>
          <div class="text-sm font-medium mb-1">Capabilities</div>
          <ul class="list-disc ml-5 text-sm space-y-1 text-slate-200">${r.capability.map((item) => `<li>${item}</li>`).join('')}</ul>
        </div>
        <div class="rounded-lg border border-cyan-500/30 bg-cyan-500/10 p-3 text-sm">LLM Logic รวมไว้ที่ <b>llmRespond()</b> เพียงจุดเดียว เพื่อลด duplicate logic และคงความสอดคล้องทุกห้องแชท</div>`;
    }

    function renderSelect(id, selected) {
      document.getElementById(id).innerHTML = roleData.map((r) => `<option value="${r.id}" ${r.id === selected ? 'selected' : ''}>${r.title}</option>`).join('');
    }

    function renderFingerprint() {
      const fp = buildFingerprint();
      document.getElementById('fingerprint').innerHTML = `
        <div class="font-semibold mb-1">Resonance Fingerprint</div>
        <div>Speed: <b>${fp.speed}</b> • Depth: <b>${fp.depth}</b> • Format: <b>${fp.format}</b></div>
        <div>Context Mode: <b>${fp.mode}</b> (${fp.label})</div>
        <div>Intent Resonance Score: <b>${(fp.score * 100).toFixed(1)}%</b></div>`;

      document.getElementById('modeExplain').textContent = fp.mode === 'visionary'
        ? 'Visionary Mode: เน้น horizon ระยะยาว, portfolio options, และการจัดสรรทุนตามความไม่แน่นอน'
        : 'Crisis Manager Mode: เน้น daily command loop, incident containment, และ reroute ทรัพยากรภายใน 1 วินาที';
    }

    function renderChatWindow() {
      const room = getRoomKey();
      if (!state.chats[room]) {
        const role = getRole(state.selectedRoleId);
        state.chats[room] = [{ role: 'assistant', text: `เปิดห้องสำหรับ ${role.title} แล้ว พร้อมวางแผนตาม meta-schema` }];
      }
      document.getElementById('chatWindow').innerHTML = state.chats[room].map((m) => `<div class="${m.role === 'user' ? 'text-right' : 'text-left'}"><div class="inline-block max-w-[95%] rounded-xl px-3 py-2 text-sm whitespace-pre-line ${m.role === 'user' ? 'bg-accent text-slate-900' : 'bg-slate-800 text-slate-100 border border-slate-600'}">${m.text}</div></div>`).join('');
      document.getElementById('modeGlobal').className = `px-3 py-1 rounded ${state.chatMode === 'global' ? 'bg-accent text-slate-900 font-semibold' : 'text-slate-300'}`;
      document.getElementById('modeRole').className = `px-3 py-1 rounded ${state.chatMode === 'role' ? 'bg-accent text-slate-900 font-semibold' : 'text-slate-300'}`;
    }

    function sendMessage() {
      const input = document.getElementById('chatInput');
      const value = input.value.trim();
      if (!value) return;
      const room = getRoomKey();
      if (!state.chats[room]) state.chats[room] = [];
      const role = getRole(state.selectedRoleId);
      state.chats[room].push({ role: 'user', text: value });
      state.chats[room].push({ role: 'assistant', text: llmRespond(role, value) });
      input.value = '';
      state.resonanceScore = Math.min(0.99, state.resonanceScore + 0.01);
      renderFingerprint();
      renderChatWindow();
    }

    function renderAll() {
      renderRoleGroups();
      renderRoleCard();
      renderSelect('chatRoleSelect', state.selectedRoleId);
      renderFingerprint();
      renderChatWindow();
    }

    document.getElementById('chatRoleSelect').onchange = (e) => { state.selectedRoleId = e.target.value; renderAll(); };
    document.getElementById('sendBtn').onclick = sendMessage;
    document.getElementById('chatInput').addEventListener('keydown', (e) => { if (e.key === 'Enter') sendMessage(); });
    document.getElementById('modeGlobal').onclick = () => { state.chatMode = 'global'; renderChatWindow(); };
    document.getElementById('modeRole').onclick = () => { state.chatMode = 'role'; renderChatWindow(); };
    ['freqSpeed', 'detailDepth', 'responseFormat', 'contextMode'].forEach((id) => {
      document.getElementById(id).onchange = () => {
        renderFingerprint();
      };
    });
    document.getElementById('runImpact').onclick = () => {
      const prompt = document.getElementById('impactPrompt').value.trim();
      document.getElementById('impactOutput').textContent = evaluateImpact(prompt);
    };

    renderAll();
  </script>
</body>
</html>
